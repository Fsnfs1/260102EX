<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>數學卷3 - 動態課堂演示 (優化版)</title>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <style>
        :root {
            --primary-color: #2c3e50; /* 深藍 - 題目 */
            --accent-color: #e67e22;  /* 橙色 - 重點/口訣 */
            --answer-color: #27ae60;  /* 綠色 - 答案 */
            --bg-color: #f4f6f7;
            --card-bg: #ffffff;
        }

        body {
            font-family: "Segoe UI", "Microsoft JhengHei", sans-serif;
            background-color: var(--bg-color);
            margin: 0;
            height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }

        /* 頂部進度條 */
        .progress-bar-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 6px;
            background-color: #e0e0e0;
        }
        .progress-bar {
            height: 100%;
            background-color: var(--primary-color);
            width: 0%;
            transition: width 0.3s ease;
        }

        /* 幻燈片卡片容器 */
        .slider-container {
            width: 90%;
            max-width: 1100px;
            height: 80vh;
            background-color: var(--card-bg);
            border-radius: 12px;
            box-shadow: 0 8px 30px rgba(0,0,0,0.12);
            position: relative;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            border: 1px solid #dcdcdc;
        }

        /* 每一頁的樣式 */
        .slide {
            flex: 1;
            display: none;
            flex-direction: column;
            padding: 40px 60px;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .slide.active {
            display: flex;
            opacity: 1;
        }

        /* 題目區域 */
        .question-header {
            font-size: 1.8rem;
            color: var(--primary-color);
            font-weight: bold;
            border-bottom: 3px solid var(--accent-color);
            padding-bottom: 15px;
            margin-bottom: 20px;
        }

        .question-content {
            font-size: 1.6rem;
            color: #34495e;
            margin-bottom: 25px;
            line-height: 1.5;
            background: #ecf0f1;
            padding: 20px;
            border-radius: 8px;
            border-left: 6px solid var(--primary-color);
        }

        /* 口訣/提示區域 */
        .hint-box {
            font-size: 1.2rem;
            color: var(--accent-color);
            font-style: italic;
            margin-bottom: 15px;
            min-height: 1.5em; /* 佔位防止跳動 */
        }

        /* 解答區域 (大容器) */
        .solution-area {
            flex: 1;
            background-color: #fff;
            overflow-y: auto;
            font-size: 1.4rem;
            padding: 10px;
        }

        /* 簡單模式的答案 */
        .simple-answer {
            display: none;
            color: var(--answer-color);
            font-weight: bold;
            font-size: 1.8rem;
            animation: popIn 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        /* 複雜模式的步驟 */
        .step-item {
            display: none;
            margin-bottom: 12px;
            padding: 10px 15px;
            border-left: 4px solid #bdc3c7;
            background: #f9f9f9;
            animation: slideIn 0.4s ease;
        }
        .step-item.highlight {
            border-left-color: var(--accent-color);
            background: #fff8e1;
        }

        /* 動畫 */
        @keyframes popIn {
            from { opacity: 0; transform: scale(0.8); }
            to { opacity: 1; transform: scale(1); }
        }
        @keyframes slideIn {
            from { opacity: 0; transform: translateX(-10px); }
            to { opacity: 1; transform: translateX(0); }
        }

        /* 控制按鈕區 */
        .controls {
            padding: 20px 40px;
            background-color: #fafafa;
            border-top: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        button {
            padding: 12px 24px;
            font-size: 1.1rem;
            cursor: pointer;
            border: none;
            border-radius: 6px;
            font-family: inherit;
            transition: all 0.2s;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .btn-nav {
            background-color: #fff;
            color: #555;
            border: 1px solid #ccc;
        }
        .btn-nav:hover { background-color: #f0f0f0; }
        .btn-nav:disabled { opacity: 0.5; cursor: not-allowed; }

        .btn-action {
            background-color: var(--primary-color);
            color: white;
            font-weight: bold;
            min-width: 160px;
        }
        .btn-action:hover {
            background-color: #34495e;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }

        .slide-info {
            font-size: 1rem;
            color: #7f8c8d;
        }
        
        /* Latex 字體調整 */
        mjx-container { font-size: 110% !important; }

    </style>
</head>
<body>

<div class="progress-bar-container">
    <div class="progress-bar" id="progressBar"></div>
</div>

<div class="slider-container">
    
    <div class="slide active" data-type="simple">
        <div class="question-header">1. 立方差公式</div>
        <div class="hint-box">口訣：前減後，後平方加乘積加平方</div>
        <div class="question-content">
            \( a^3 - b^3 = ( a - b )( \quad ? \quad ) \)
        </div>
        <div class="solution-area">
            <div class="simple-answer">
                \( a^2 + ab + b^2 \)
            </div>
        </div>
    </div>

    <div class="slide" data-type="simple">
        <div class="question-header">2. 同底數冪運算</div>
        <div class="hint-box">口訣：底數不變，指數相加</div>
        <div class="question-content">
            \( a^m \cdot a^n = \quad ? \)
        </div>
        <div class="solution-area">
            <div class="simple-answer">
                \( a^{m+n} \)
            </div>
        </div>
    </div>

    <div class="slide" data-type="simple">
        <div class="question-header">3. 換底公式</div>
        <div class="hint-box">口訣：舊底在下，新底在上</div>
        <div class="question-content">
            \( \log_a b = \quad ? \)
        </div>
        <div class="solution-area">
            <div class="simple-answer">
                \( \frac{\log_c b}{\log_c a} \)
            </div>
        </div>
    </div>

    <div class="slide" data-type="simple">
        <div class="question-header">4. 斜率公式</div>
        <div class="hint-box">重點：縱座標差 除以 橫座標差</div>
        <div class="question-content">
            \( k = \frac{y_2 - y_1}{ \quad ? \quad } \)
        </div>
        <div class="solution-area">
            <div class="simple-answer">
                \( x_2 - x_1 \)
            </div>
        </div>
    </div>

    <div class="slide" data-type="simple">
        <div class="question-header">5. 點到直線距離</div>
        <div class="hint-box">重點：分母是係數平方和開根號</div>
        <div class="question-content">
            \( d = \frac{|Ax_0 + By_0 + C|}{ \quad ? \quad } \)
        </div>
        <div class="solution-area">
            <div class="simple-answer">
                \( \sqrt{A^2 + B^2} \)
            </div>
        </div>
    </div>

    <div class="slide" data-type="complex">
        <div class="question-header">6. 集合補集運算</div>
        <div class="hint-box">畫圈圈圖，用手把 1,3,5 蓋住，看剩下誰</div>
        <div class="question-content">
            全集 \( U=\{1, 2, 3, 4, 5, 6\} \)，\( A=\{1, 3, 5\} \)。<br>
            求 \( C_U A \)。
        </div>
        <div class="solution-area">
            <div class="step-item">1. 全集元素：1, 2, 3, 4, 5, 6</div>
            <div class="step-item">2. 剔除 A 的元素 (1, 3, 5)</div>
            <div class="step-item highlight">3. 答案：\( \{2, 4, 6\} \)</div>
        </div>
    </div>

    <div class="slide" data-type="simple">
        <div class="question-header">7. 奇偶函數判斷</div>
        <div class="hint-box">提示：觀察次方是否都是奇數</div>
        <div class="question-content">
            函數 \( f(x) = x^3 + x \) 是奇函數還是偶函數？
        </div>
        <div class="solution-area">
            <div class="simple-answer">
                奇函數
            </div>
        </div>
    </div>

    <div class="slide" data-type="complex">
        <div class="question-header">8. 拋物線性質</div>
        <div class="hint-box">認準一次項是 x，所以焦點在 x 軸</div>
        <div class="question-content">
            拋物線 \( y^2 = 8x \)。求 \(p\) 及焦點座標。
        </div>
        <div class="solution-area">
            <div class="step-item">1. 對比標準式 \( y^2 = 2px \) (或 \(4cx\))，\( 2p = 8 \implies p = 4 \) (若教材用 \(y^2=2px\))。<br>
            *註：若教材用 \(y^2=4px\)，則 \(4p=8 \implies p=2\)。此處按常見標準取係數對應。</div>
            <div class="step-item highlight">2. 焦點在 x 軸正半軸：\( (2, 0) \)</div>
        </div>
    </div>

    <div class="slide" data-type="complex">
        <div class="question-header">9. 期望值計算</div>
        <div class="hint-box">上下對齊相乘，然後全部加起來</div>
        <div class="question-content">
            數據：0, 1, 2, 3 對應概率 0.1, 0.3, 0.4, 0.2<br>
            求 E(X)。
        </div>
        <div class="solution-area">
            <div class="step-item">乘積：\( 0 + 0.3 + 0.8 + 0.6 \)</div>
            <div class="step-item highlight">加總答案：\( 1.7 \)</div>
        </div>
    </div>

    <div class="slide" data-type="simple">
        <div class="question-header">10. 方差性質</div>
        <div class="hint-box">方差只看倍數的平方，+7 是干擾項直接劃掉</div>
        <div class="question-content">
            已知 \( D(Y) = 1 \)，求 \( D(-2Y + 7) \)。
        </div>
        <div class="solution-area">
            <div class="simple-answer">
                \( (-2)^2 \times 1 = 4 \)
            </div>
        </div>
    </div>

    <div class="slide" data-type="simple">
        <div class="question-header">11. 直線參數求解</div>
        <div class="hint-box">把 \(x=-1, y=3\) 代入方程</div>
        <div class="question-content">
            點 \( A(-1, 3) \) 在 \( y + 2x = m \) 上，求 \( m \)。
        </div>
        <div class="solution-area">
            <div class="simple-answer">
                \( 3 + 2(-1) = 1 \)
            </div>
        </div>
    </div>

    <div class="slide" data-type="simple">
        <div class="question-header">12. 函數值計算</div>
        <div class="hint-box">代入 x=1</div>
        <div class="question-content">
            \( f(x) = 3x^2 + x + 4 \)，求 \( f(1) \)。
        </div>
        <div class="solution-area">
            <div class="simple-answer">
                \( 3(1)^2 + 1 + 4 = 8 \)
            </div>
        </div>
    </div>

    <div class="slide" data-type="simple">
        <div class="question-header">13. 不等式集合交集</div>
        <div class="hint-box">畫兩條線，找重疊部分 (大大取大，小小取小)</div>
        <div class="question-content">
            \( A = (1, 5) \)，\( B = (0, 4) \)。求 \( A \cap B \)。
        </div>
        <div class="solution-area">
            <div class="simple-answer">
                \( \{ x \mid 1 < x < 4 \} \)
            </div>
        </div>
    </div>

    <div class="slide" data-type="simple">
        <div class="question-header">14. 平均數逆運算</div>
        <div class="hint-box">總和 = 平均數 × 個數</div>
        <div class="question-content">
            0, 2, x 的平均數是 1，求 x。
        </div>
        <div class="solution-area">
            <div class="simple-answer">
                \( (0+2+x) = 3 \implies x = 1 \)
            </div>
        </div>
    </div>

    <div class="slide" data-type="complex">
        <div class="question-header">15. 古典概型</div>
        <div class="hint-box">分子：各色取1球；分母：任意取3球</div>
        <div class="question-content">
            2綠、3紅、4黃 (共9球)。取3球顏色都不同的概率。
        </div>
        <div class="solution-area">
            <div class="step-item">分母：\( C^9_3 = 84 \)</div>
            <div class="step-item">分子：\( C^2_1 \times C^3_1 \times C^4_1 = 2 \times 3 \times 4 = 24 \)</div>
            <div class="step-item highlight">答案：\( \frac{24}{84} = \frac{2}{7} \)</div>
        </div>
    </div>

    <div class="slide" data-type="complex">
        <div class="question-header">16. 橢圓性質分析</div>
        <div class="hint-box">注意分母 25 比較大，在 y 軸</div>
        <div class="question-content">
            \( \frac{x^2}{16} + \frac{y^2}{25} = 1 \)
        </div>
        <div class="solution-area">
            <div class="step-item">1. 參數：\( a^2=25 \Rightarrow a=5 \), \( b^2=16 \Rightarrow b=4 \)</div>
            <div class="step-item">2. 焦距：\( c = \sqrt{25-16} = 3 \)</div>
            <div class="step-item">3. 焦點 (y軸)：\( (0, \pm 3) \)</div>
            <div class="step-item highlight">4. 離心率：\( e = c/a = 3/5 = 0.6 \)</div>
        </div>
    </div>

    <div class="slide" data-type="complex">
        <div class="question-header">17. 解對數方程</div>
        <div class="hint-box">合併 -> 去對數 -> 解方程 -> 驗根</div>
        <div class="question-content">
            \( \lg(x-1) + \lg(x-2) = \lg 2 \)
        </div>
        <div class="solution-area">
            <div class="step-item">合併：\( \lg[(x-1)(x-2)] = \lg 2 \)</div>
            <div class="step-item">去對數：\( x^2 - 3x + 2 = 2 \implies x^2 - 3x = 0 \)</div>
            <div class="step-item">解得：\( x=0 \) 或 \( x=3 \)</div>
            <div class="step-item highlight">驗根：\( x=0 \) 使真數 < 0 (捨去)。<br>答案：\( x=3 \)</div>
        </div>
    </div>

    <div class="slide" data-type="complex">
        <div class="question-header">18. 韋達定理求值</div>
        <div class="hint-box">兩根和、兩根積公式</div>
        <div class="question-content">
            \( x^2 + 5x + 6 = 0 \) 兩根為 \( \alpha, \beta \)。求 \( \alpha^2 + \beta^2 \)。
        </div>
        <div class="solution-area">
            <div class="step-item">\( \alpha + \beta = -5 \)，\( \alpha\beta = 6 \)</div>
            <div class="step-item">變形：\( (\alpha+\beta)^2 - 2\alpha\beta \)</div>
            <div class="step-item highlight">計算：\( (-5)^2 - 2(6) = 25 - 12 = 13 \)</div>
        </div>
    </div>

    <div class="slide" data-type="complex">
        <div class="question-header">19. 餘式定理</div>
        <div class="hint-box">令除式為0，代入被除式</div>
        <div class="question-content">
            求 \( (2x^3 + 3x - 62) \div (x - 3) \) 的餘式。
        </div>
        <div class="solution-area">
            <div class="step-item">令 \( x-3=0 \implies x=3 \)</div>
            <div class="step-item">代入：\( 2(3)^3 + 3(3) - 62 \)</div>
            <div class="step-item">計算：\( 54 + 9 - 62 \)</div>
            <div class="step-item highlight">答案：1</div>
        </div>
    </div>

</div>

<div class="controls">
    <button class="btn-nav" id="prevBtn" onclick="changeSlide(-1)">&#10094; 上一題</button>
    
    <div style="text-align: center;">
        <button class="btn-action" id="actionBtn" onclick="triggerAction()">顯示答案</button>
        <div class="slide-info" id="slideInfo">1 / 19</div>
    </div>

    <button class="btn-nav" id="nextBtn" onclick="changeSlide(1)">下一題 &#10095;</button>
</div>

<script>
    let currentSlideIndex = 0;
    const slides = document.querySelectorAll('.slide');
    const totalSlides = slides.length;
    
    const prevBtn = document.getElementById('prevBtn');
    const nextBtn = document.getElementById('nextBtn');
    const actionBtn = document.getElementById('actionBtn');
    const slideInfo = document.getElementById('slideInfo');
    const progressBar = document.getElementById('progressBar');

    function init() {
        showSlide(0);
    }

    function showSlide(index) {
        slides.forEach(s => s.classList.remove('active'));
        slides[index].classList.add('active');
        
        currentSlideIndex = index;
        updateUI();
        resetSlideState(slides[index]);
    }

    function changeSlide(direction) {
        let newIndex = currentSlideIndex + direction;
        if (newIndex >= 0 && newIndex < totalSlides) {
            showSlide(newIndex);
        }
    }

    function updateUI() {
        // 更新按鈕狀態
        prevBtn.disabled = currentSlideIndex === 0;
        nextBtn.disabled = currentSlideIndex === totalSlides - 1;
        slideInfo.innerText = `${currentSlideIndex + 1} / ${totalSlides}`;
        
        // 更新進度條
        const progress = ((currentSlideIndex + 1) / totalSlides) * 100;
        progressBar.style.width = `${progress}%`;

        // 更新中間按鈕文字
        const currentSlide = slides[currentSlideIndex];
        const type = currentSlide.getAttribute('data-type');
        if (type === 'simple') {
            actionBtn.innerText = "顯示答案";
        } else {
            actionBtn.innerText = "逐步講解";
        }
    }

    function resetSlideState(slide) {
        // 重置所有答案和步驟為隱藏
        slide.querySelectorAll('.simple-answer').forEach(el => el.style.display = 'none');
        slide.querySelectorAll('.step-item').forEach(el => el.style.display = 'none');
        
        // 確保滾動條在頂部
        const solutionArea = slide.querySelector('.solution-area');
        if(solutionArea) solutionArea.scrollTop = 0;
    }

    function triggerAction() {
        const currentSlide = slides[currentSlideIndex];
        const type = currentSlide.getAttribute('data-type');
        const solutionArea = currentSlide.querySelector('.solution-area');

        if (type === 'simple') {
            // 簡單模式：直接顯示答案
            const answer = currentSlide.querySelector('.simple-answer');
            if (answer && answer.style.display !== 'block') {
                answer.style.display = 'block';
            }
        } else {
            // 複雜模式：顯示下一步
            const steps = currentSlide.querySelectorAll('.step-item');
            let foundHidden = false;
            for (let step of steps) {
                if (step.style.display !== 'block') {
                    step.style.display = 'block';
                    solutionArea.scrollTop = solutionArea.scrollHeight; // 自動滾動到底部
                    foundHidden = true;
                    break;
                }
            }
            if (!foundHidden) {
                // 如果步驟都顯示完了，按鈕可以變成灰色或者無反應，這裡暫時不做處理
                // actionBtn.innerText = "已完成";
            }
        }
    }

    // 鍵盤控制
    document.addEventListener('keydown', (e) => {
        if (e.key === 'ArrowRight' || e.key === 'PageDown') changeSlide(1);
        if (e.key === 'ArrowLeft' || e.key === 'PageUp') changeSlide(-1);
        if (e.key === ' ' || e.key === 'Enter') triggerAction();
    });

    init();
</script>

</body>
</html>